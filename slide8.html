<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pocket Guardian Tail ‚Äî Slide 8</title>

  <link rel="stylesheet" href="ui.css" />

  <style>
    :root{
      --fg:#fff; --muted:rgba(255,255,255,.78);
      --line:rgba(255,255,255,.18);
      --accent:#e08a2e; --accent2:#5bb7ff; --danger:#ff6b6b;
      --btn:rgba(0,0,0,.35); --btnHover:rgba(0,0,0,.55);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans Thai",sans-serif;color:var(--fg);background:#000;overflow:hidden}

    .bgKey{position:fixed;inset:-40px;z-index:-6;width:calc(100% + 80px);height:calc(100% + 80px);object-fit:cover;filter:blur(18px) saturate(1.05) contrast(1.05);opacity:.22;transform:scale(1.06)}
    .bg{position:fixed;inset:0;z-index:-5;background:
      radial-gradient(900px 520px at 18% 25%, rgba(91,183,255,.16), transparent 60%),
      radial-gradient(900px 520px at 82% 28%, rgba(224,138,46,.14), transparent 60%),
      linear-gradient(180deg, rgba(0,0,0,.58), rgba(0,0,0,.90));
    }

    .wrap{height:100%;max-width:1280px;margin:0 auto;padding:70px 22px 22px;display:flex;flex-direction:column;gap:12px;min-height:0}

    /* top mini pills */
    .kicker{display:inline-flex;gap:10px;align-items:center;padding:8px 10px;border:1px solid rgba(255,255,255,.18);border-radius:999px;background:rgba(0,0,0,.25);color:var(--muted);font-size:12px;backdrop-filter:blur(10px);user-select:none;width:fit-content}
    .pill{padding:4px 8px;border-radius:999px;border:1px solid rgba(255,255,255,.14);background:rgba(0,0,0,.25);color:rgba(255,255,255,.86);font-weight:900;font-size:11px;letter-spacing:.04em}

    .kickerRow{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;flex-wrap:wrap}

    /* small header box right */
    .topBox{border:1px solid var(--line);background:rgba(0,0,0,.34);border-radius:16px;backdrop-filter:blur(14px);box-shadow:0 20px 60px rgba(0,0,0,.30);overflow:hidden;padding:10px 12px;max-width:560px;margin-left:auto}
    .topBox h1{margin:0;font-size:28px;line-height:1.12;letter-spacing:.2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
    .topBox .sub{margin:6px 0 0;color:var(--muted);font-size:12px;line-height:1.55;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}

    .grid{display:grid;grid-template-columns:1.15fr .85fr;gap:12px;min-height:0;flex:1}
    .card{border:1px solid rgba(255,255,255,.14);background:rgba(0,0,0,.28);border-radius:18px;backdrop-filter:blur(12px);box-shadow:0 18px 55px rgba(0,0,0,.22);overflow:hidden;min-height:0}

    /* left */
    .flow{display:flex;flex-direction:column;min-height:0}
    .flowTop{padding:10px 12px;border-bottom:1px solid rgba(255,255,255,.12);display:flex;align-items:center;justify-content:space-between;gap:10px;flex-wrap:wrap}
    .label{font-weight:900;letter-spacing:.05em;text-transform:uppercase;font-size:12px;color:rgba(255,255,255,.88);display:flex;gap:8px;align-items:center}
    .dot{width:10px;height:10px;border-radius:999px;background:var(--accent2);box-shadow:0 0 0 3px rgba(91,183,255,.18)}
    .btn{border:1px solid rgba(255,255,255,.25);background:var(--btn);color:#fff;padding:10px 14px;border-radius:10px;font-weight:900;cursor:pointer;backdrop-filter:blur(10px);display:inline-flex;align-items:center;gap:8px;user-select:none}
    .btn:hover{background:var(--btnHover)}
    .btn.primary{background:var(--accent);border-color:var(--accent)}

    .carousel{flex:1;min-height:0;padding:12px;display:flex;flex-direction:column;gap:10px}
    .stage{position:relative;flex:1 1 auto;min-height:420px;border-radius:16px;overflow:hidden;border:1px solid rgba(255,255,255,.14);background:rgba(0,0,0,.22)}
    .stage img{width:100%;height:100%;object-fit:cover;display:block;opacity:0;transition:opacity .55s ease}
    .stage img.ready{opacity:1}
    .stageTag,.stageMeta{position:absolute;left:12px;padding:8px 10px;border-radius:12px;border:1px solid rgba(255,255,255,.16);background:rgba(0,0,0,.35);font-size:12px;color:rgba(255,255,255,.90);backdrop-filter:blur(10px);max-width:calc(100% - 24px);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}
    .stageTag{top:12px}
    .stageMeta{bottom:12px;color:rgba(255,255,255,.86)}
    .stageEmpty{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;text-align:center;padding:18px;color:rgba(255,255,255,.80);font-size:13px;background:linear-gradient(180deg, rgba(0,0,0,.20), rgba(0,0,0,.55));opacity:0;pointer-events:none;transition:opacity .2s ease}
    .stageEmpty.show{opacity:1}

    .strip{flex:0 0 auto;display:flex;gap:10px;overflow-x:auto;max-height:140px;padding-bottom:4px}
    .strip::-webkit-scrollbar{height:10px}
    .strip::-webkit-scrollbar-thumb{background:rgba(255,255,255,.22);border-radius:999px}
    .node{flex:0 0 auto;width:180px;border-radius:14px;border:1px solid rgba(255,255,255,.14);background:rgba(0,0,0,.22);overflow:hidden;cursor:pointer;opacity:.92}
    .node:hover{opacity:1}
    .node.active{outline:2px solid rgba(224,138,46,.9)}
    .node img{width:100%;height:78px;object-fit:cover;display:block}
    .cap{padding:8px 10px;font-size:12px;color:rgba(255,255,255,.88);line-height:1.3;border-top:1px solid rgba(255,255,255,.10);background:rgba(0,0,0,.22);font-weight:900}
    .small{display:block;margin-top:3px;font-weight:700;color:rgba(255,255,255,.70);font-size:10px}

    /* right */
    .right{display:flex;flex-direction:column;min-height:0;gap:10px;padding:12px;overflow:auto;padding-right:10px}
    .panel{border:1px solid rgba(255,255,255,.14);background:rgba(255,255,255,.06);border-radius:16px;padding:14px 14px 12px}
    .panel h3{margin:0 0 10px 0;font-size:12px;letter-spacing:.05em;text-transform:uppercase;opacity:.95;display:flex;gap:8px;align-items:center}
    ul{margin:0;padding-left:18px;color:rgba(255,255,255,.86);font-size:14.5px;line-height:1.65}
    li{margin:7px 0}

    .nav{display:flex;justify-content:space-between;align-items:center;gap:12px;padding-top:2px}
    .navHint{color:var(--muted);font-size:12px;user-select:none}

    /* player */
    .player{position:fixed;left:22px;bottom:18px;z-index:1500;display:flex;gap:10px;align-items:center;padding:10px 12px;border-radius:14px;border:1px solid rgba(255,255,255,.18);background:rgba(0,0,0,.40);backdrop-filter:blur(12px);box-shadow:0 18px 55px rgba(0,0,0,.28);max-width:min(720px, calc(100vw - 44px));flex-wrap:wrap}
    .tag{font-size:11px;font-weight:900;letter-spacing:.06em;padding:4px 8px;border-radius:999px;border:1px solid rgba(255,255,255,.14);background:rgba(0,0,0,.25);color:rgba(255,255,255,.88);user-select:none}
    .pbtn{border:1px solid rgba(255,255,255,.22);background:rgba(0,0,0,.28);color:#fff;padding:7px 10px;border-radius:10px;cursor:pointer;font-weight:900;backdrop-filter:blur(10px);user-select:none}
    .pbtn:hover{background:rgba(0,0,0,.45)}
    .name{color:rgba(255,255,255,.85);font-size:12px;max-width:300px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;user-select:none}
    input[type="range"]{width:150px;accent-color:var(--accent);cursor:pointer}

    /* Debug overlay (shows JS errors on screen) */
    .dbg{
      position:fixed;left:18px;top:18px;z-index:9999;
      max-width:min(720px, calc(100vw - 36px));
      padding:10px 12px;border-radius:12px;
      border:1px solid rgba(255,107,107,.35);
      background:rgba(0,0,0,.65);
      color:rgba(255,255,255,.92);
      font-size:12px;line-height:1.35;
      display:none;
      backdrop-filter:blur(10px);
      white-space:pre-wrap;
    }

    @media (max-width:980px){
      body{overflow:auto}
      .wrap{padding-top:64px;height:auto}
      .grid{grid-template-columns:1fr}
      .stage{min-height:340px}
      .node{width:170px}
      .name{max-width:180px}
      .topBox{max-width:100%}
      .topBox h1{white-space:normal}
    }
  </style>
</head>

<body>
  <div class="dbg" id="dbg"></div>

  <img id="s8_bgKey" class="bgKey" alt="Safe Room key visual background" />
  <div class="bg"></div>

  <!-- NOTE: ‡∏õ‡∏∏‡πà‡∏° EN/TH/Zoom ‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏Ñ‡∏∏‡∏ì‡∏¢‡∏±‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏≤‡∏Å ui.js -->
  <!-- ‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏° EN/TH ‡∏ã‡πâ‡∏≥ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡∏ä‡∏ô‡∏Å‡∏±‡∏ö ui.js -->

  <div class="wrap">
    <div class="kickerRow">
      <div class="kicker" id="s8_kicker"></div>

      <div class="topBox">
        <h1 id="s8_title"></h1>
        <div class="sub" id="s8_subtitle"></div>
      </div>
    </div>

    <div class="grid">
      <section class="card flow">
        <div class="flowTop">
          <div class="label"><span class="dot"></span><span id="s8_flowLabel"></span></div>
          <div style="display:flex;gap:8px;flex-wrap:wrap;">
            <button class="btn" id="s8_prevRoom" type="button">‚Üê</button>
            <button class="btn" id="s8_nextRoom" type="button">‚Üí</button>
          </div>
        </div>

        <div class="carousel">
          <div class="stage">
            <img id="s8_stageImg" alt="Safe Room visual" />
            <div class="stageEmpty" id="s8_stageEmpty">
              Image failed to load (URL / filename)<br/>‡∏•‡∏≠‡∏á Ctrl+F5 ‡∏´‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ö‡∏ô GitHub
            </div>
            <div class="stageTag" id="s8_stageTag"></div>
            <div class="stageMeta" id="s8_stageMeta">Loading‚Ä¶</div>
          </div>

          <div class="strip" id="s8_strip"></div>
        </div>
      </section>

      <section class="card right">
        <div class="panel">
          <h3><span class="dot"></span><span id="s8_h1"></span></h3>
          <ul id="s8_u1"></ul>
        </div>

        <div class="panel">
          <h3><span class="dot" style="background:var(--accent);box-shadow:0 0 0 3px rgba(224,138,46,.18)"></span><span id="s8_h2"></span></h3>
          <ul id="s8_u2"></ul>
        </div>

        <div class="panel">
          <h3><span class="dot" style="background:var(--danger);box-shadow:0 0 0 3px rgba(255,107,107,.16)"></span><span id="s8_h3"></span></h3>
          <ul id="s8_u3"></ul>
        </div>
      </section>
    </div>

    <div class="nav">
      <div class="navHint" id="s8_navHint"></div>
      <div style="display:flex;gap:10px;flex-wrap:wrap;">
        <button class="btn" id="s8_backBtn" type="button">‚¨ÖÔ∏è Back</button>
        <button class="btn primary" id="s8_nextBtn" type="button">Next ‚ûú</button>
      </div>
    </div>
  </div>

  <div class="player" id="s8_player">
    <span class="tag">BGM</span>
    <button class="pbtn" id="s8_playBtn" type="button">‚ñ∂Ô∏è</button>
    <button class="pbtn" id="s8_muteBtn" type="button">üîà</button>
    <span class="name">Safe Room (Loft Style)</span>
    <input id="s8_vol" type="range" min="0" max="1" step="0.01" value="0.55" />
    <button class="pbtn" id="s8_volDown" type="button">‚àí</button>
    <button class="pbtn" id="s8_volUp" type="button">+</button>
  </div>

  <audio id="s8_bgm" preload="auto" loop></audio>

  <script>
    // ====== Debug overlay: show JS error on screen ======
    (function(){
      const dbg = document.getElementById("dbg");
      function show(msg){
        dbg.style.display = "block";
        dbg.textContent = "Slide8 JS Error:\\n" + msg;
      }
      window.addEventListener("error", (e)=>{
        show((e.message || "Unknown error") + "\\n" + (e.filename||"") + ":" + (e.lineno||"") );
      });
      window.addEventListener("unhandledrejection", (e)=>{
        show("Unhandled Promise Rejection:\\n" + (e.reason?.message || e.reason || "unknown"));
      });
    })();

    // ====== IMPORTANT: RAW main URLs only ======
    const S8_ASSETS = {
      keyVisualBg: "https://raw.githubusercontent.com/sopwerdream/Pocket-Guardian-Tail/main/assets/key%20visual%20Safe%20Room/key%20visual%20Safe%20Room.png",
      rooms: [
        "https://raw.githubusercontent.com/sopwerdream/Pocket-Guardian-Tail/main/assets/key%20visual%20Safe%20Room/Character%20customization%20and%20setting..png",
        "https://raw.githubusercontent.com/sopwerdream/Pocket-Guardian-Tail/main/assets/key%20visual%20Safe%20Room/Craft%20room%20And%20wear%20the%20equipment..png",
        "https://raw.githubusercontent.com/sopwerdream/Pocket-Guardian-Tail/main/assets/key%20visual%20Safe%20Room/Enter%20the%20skill%20upgrade%20room..png",
        "https://raw.githubusercontent.com/sopwerdream/Pocket-Guardian-Tail/main/assets/key%20visual%20Safe%20Room/Map%20and%20Mission%20Event%20Room.png",
        "https://raw.githubusercontent.com/sopwerdream/Pocket-Guardian-Tail/main/assets/key%20visual%20Safe%20Room/storage%20room.png"
      ],
      bgm: "https://raw.githubusercontent.com/sopwerdream/Pocket-Guardian-Tail/main/assets/song/Safe%20Room%20(Loft%20Style).mp3",
      rotateMs: 4200
    };

    const BACK_PAGE = "slide7.html";
    const NEXT_PAGE = "slide9.html";

    const TH = {
      kicker: "Slide 8  ‚Ä¢  SAFE ROOM / POCKET HOME  ‚Ä¢  System  ‚Ä¢  8/10",
      title: "A Strategic Hub Between Battles",
      subtitle: "Safe Room (Pocket Home) ‡∏Ñ‡∏∑‡∏≠ ‚Äú‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‚Äù ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÅ‡∏Ñ‡πà‡∏ó‡∏µ‡πà‡∏û‡∏±‡∏Å ‡πÅ‡∏ï‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô / ‡πÄ‡∏®‡∏£‡∏©‡∏ê‡∏Å‡∏¥‡∏à / ‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏¥‡∏ö‡πÇ‡∏ï‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£ ‚Äî ‡∏ó‡∏∏‡∏Å‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏™‡πà‡∏á‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡πÉ‡∏ô‡∏™‡∏ô‡∏≤‡∏°‡∏£‡∏ö‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á",
      flowLabel: "SAFE ROOM ROOMS (HORIZONTAL FLOW)",
      stageTag: "SAFE ROOM ‚Ä¢ Multi-Room Hub",
      navHint: "Back ‚Üí Slide 7 ‚Ä¢ Next ‚Üí Slide 9",

      h1: "‡πÅ‡∏ô‡∏ß‡∏Ñ‡∏¥‡∏î‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á SAFE ROOM",
      u1: [
        "‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô (Decision Hub)",
        "‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°: Gameplay Loop + Economy + Character Growth",
        "‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡πÉ‡∏ô Safe Room ‚Üí ‡∏™‡∏∞‡∏ó‡πâ‡∏≠‡∏ô‡∏ú‡∏•‡πÉ‡∏ô Battle ‡πÇ‡∏î‡∏¢‡∏ï‡∏£‡∏á"
      ],
      h2: "‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏•‡∏±‡∏Å‡∏†‡∏≤‡∏¢‡πÉ‡∏ô SAFE ROOM",
      u2: [
        "Trading & Shop: ‡πÉ‡∏ä‡πâ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡πà‡∏ô‡∏à‡∏£‡∏¥‡∏á ‡πÑ‡∏≠‡πÄ‡∏ó‡∏°‡πÄ‡∏õ‡πá‡∏ô Equipment / Materials / Support",
        "‡∏£‡∏≤‡∏Ñ‡∏≤‡∏Ç‡∏≠‡∏á/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏≤‡∏¢‡∏≤‡∏Å‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ï‡∏≤‡∏° Progress ‡πÅ‡∏•‡∏∞‡πÄ‡∏´‡∏ï‡∏∏‡∏Å‡∏≤‡∏£‡∏ì‡πå‡πÉ‡∏ô Pocket World",
        "Skill Upgrade Room: Skill Tree ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏¢ Damage / Support / Control ‡πÅ‡∏•‡∏∞ ‚Äú‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏™‡∏Å‡∏¥‡∏•‚Äù ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÅ‡∏Ñ‡πà‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç",
        "Equipment & Craft: Stat / Passive / Playstyle + Visual Customization"
      ],
      h3: "WHY IT MATTERS (BUSINESS)",
      u3: [
        "‡πÅ‡∏Å‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡∏ï‡πå‡πÉ‡∏ô‡∏≠‡∏ô‡∏≤‡∏Ñ‡∏ï (Rooms/Systems ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏¢ ‡πÜ)",
        "‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏≠‡πÄ‡∏ó‡∏°/‡∏™‡∏Å‡∏¥‡∏ô/‡∏Ç‡∏≠‡∏á‡∏™‡∏∞‡∏™‡∏° ‡πÅ‡∏•‡∏∞ Event-based Content",
        "(Future) ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö Live Update ‡πÅ‡∏•‡∏∞ Monetization ‡∏ö‡∏ô‡πÅ‡∏û‡∏•‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏≠‡∏∑‡πà‡∏ô"
      ],
      rooms: [
        {t:"Character Customization & Setting", s:"‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏±‡∏ß/‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£"},
        {t:"Craft Room & Equipment", s:"‡∏Ñ‡∏£‡∏≤‡∏ü‡∏ï‡πå/‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå"},
        {t:"Skill Upgrade Room", s:"‡∏≠‡∏±‡∏õ‡πÄ‡∏Å‡∏£‡∏î‡∏™‡∏Å‡∏¥‡∏•"},
        {t:"Map & Mission Event Room", s:"‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà/‡∏†‡∏≤‡∏£‡∏Å‡∏¥‡∏à/‡∏≠‡∏µ‡πÄ‡∏ß‡∏ô‡∏ï‡πå"},
        {t:"Storage Room", s:"‡∏Ñ‡∏•‡∏±‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏≠‡∏á"}
      ]
    };

    // ---- init DOM
    document.getElementById("s8_bgKey").src = S8_ASSETS.keyVisualBg;
    document.getElementById("s8_kicker").textContent = TH.kicker;
    document.getElementById("s8_title").textContent = TH.title;
    document.getElementById("s8_subtitle").textContent = TH.subtitle;
    document.getElementById("s8_flowLabel").textContent = TH.flowLabel;
    document.getElementById("s8_stageTag").textContent = TH.stageTag;
    document.getElementById("s8_navHint").textContent = TH.navHint;

    function renderList(id, arr){
      document.getElementById(id).innerHTML = arr.map(x=>`<li>${x}</li>`).join("");
    }
    document.getElementById("s8_h1").textContent = TH.h1; renderList("s8_u1", TH.u1);
    document.getElementById("s8_h2").textContent = TH.h2; renderList("s8_u2", TH.u2);
    document.getElementById("s8_h3").textContent = TH.h3; renderList("s8_u3", TH.u3);

    document.getElementById("s8_backBtn").onclick = ()=> location.href = BACK_PAGE;
    document.getElementById("s8_nextBtn").onclick = ()=> location.href = NEXT_PAGE;
    window.addEventListener("keydown",(e)=>{
      if(e.key==="ArrowLeft") location.href = BACK_PAGE;
      if(e.key==="ArrowRight") location.href = NEXT_PAGE;
    });

    // ---- carousel
    const strip = document.getElementById("s8_strip");
    const stageImg = document.getElementById("s8_stageImg");
    const stageMeta = document.getElementById("s8_stageMeta");
    const stageEmpty = document.getElementById("s8_stageEmpty");
    let idx = 0;
    let timer = null;

    function setStage(i){
      idx = i;
      stageEmpty.classList.remove("show");
      stageImg.classList.remove("ready");
      stageMeta.textContent = "Loading‚Ä¶";

      stageImg.onload = ()=>{
        stageImg.classList.add("ready");
        stageMeta.textContent = TH.rooms[idx].t;
      };
      stageImg.onerror = ()=>{
        stageMeta.textContent = "Image failed to load";
        stageEmpty.classList.add("show");
      };

      const url = S8_ASSETS.rooms[idx];
      stageImg.src = url + "?v=" + Date.now();
      [...strip.querySelectorAll(".node")].forEach(n=>{
        n.classList.toggle("active", Number(n.dataset.idx) === idx);
      });
    }

    function buildStrip(){
      strip.innerHTML = "";
      S8_ASSETS.rooms.forEach((url,i)=>{
        const node = document.createElement("div");
        node.className = "node";
        node.dataset.idx = i;

        const img = document.createElement("img");
        img.src = url;

        const cap = document.createElement("div");
        cap.className = "cap";
        cap.innerHTML = `<span>${TH.rooms[i].t}</span><span class="small">${TH.rooms[i].s}</span>`;

        node.appendChild(img);
        node.appendChild(cap);
        node.onclick = ()=> { setStage(i); restart(); };

        strip.appendChild(node);
      });
    }

    function restart(){
      if(timer) clearInterval(timer);
      timer = setInterval(()=>{
        setStage((idx + 1) % S8_ASSETS.rooms.length);
      }, S8_ASSETS.rotateMs);
    }

    document.getElementById("s8_prevRoom").onclick = ()=>{ setStage((idx - 1 + S8_ASSETS.rooms.length) % S8_ASSETS.rooms.length); restart(); };
    document.getElementById("s8_nextRoom").onclick = ()=>{ setStage((idx + 1) % S8_ASSETS.rooms.length); restart(); };

    buildStrip();
    setStage(0);
    restart();

    // ---- audio (manual play; autoplay may be blocked)
    const bgm = document.getElementById("s8_bgm");
    bgm.src = S8_ASSETS.bgm;
    bgm.volume = 0.55;

    const playBtn = document.getElementById("s8_playBtn");
    const muteBtn = document.getElementById("s8_muteBtn");
    const vol = document.getElementById("s8_vol");
    const vd = document.getElementById("s8_volDown");
    const vu = document.getElementById("s8_volUp");

    function upd(){ playBtn.textContent = bgm.paused ? "‚ñ∂Ô∏è" : "‚è∏Ô∏è"; muteBtn.textContent = bgm.muted ? "üîá" : "üîà"; }
    upd();

    playBtn.onclick = async ()=>{
      try{
        if(bgm.paused) await bgm.play();
        else bgm.pause();
      }catch(e){}
      upd();
    };
    muteBtn.onclick = ()=>{ bgm.muted = !bgm.muted; upd(); };
    vol.oninput = ()=>{ bgm.volume = Number(vol.value); bgm.muted = (bgm.volume===0); upd(); };
    vd.onclick = ()=>{ vol.value = String(Math.max(0, Number(vol.value)-0.05)); vol.oninput(); };
    vu.onclick = ()=>{ vol.value = String(Math.min(1, Number(vol.value)+0.05)); vol.oninput(); };
  </script>

  <!-- ‚úÖ ui.js ‡πÇ‡∏´‡∏•‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ä‡∏ô/‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå‡∏™‡πÑ‡∏•‡∏î‡πå 8 ‡∏´‡∏¢‡∏∏‡∏î -->
  <script src="ui.js"></script>
</body>
</html>
