<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pocket Guardian Tail ‚Äì Auto Slides</title>
  <style>
    body { margin:0; font-family: system-ui, sans-serif; background:#0b1020; color:#fff; }
    header { padding:16px 20px; border-bottom:1px solid rgba(255,255,255,.1); }
    .wrap { max-width:1100px; margin:0 auto; padding:16px; }
    .viewer { position:relative; background:#111a33; border-radius:16px; overflow:hidden; aspect-ratio: 16/9; display:flex; align-items:center; justify-content:center; }
    .viewer img { width:100%; height:100%; object-fit:contain; display:block; }
    .caption { margin-top:10px; opacity:.9; font-size:14px; word-break:break-all; }
    .controls { display:flex; gap:10px; margin-top:12px; flex-wrap:wrap; }
    button {
      background:rgba(255,255,255,.12); color:#fff; border:1px solid rgba(255,255,255,.18);
      padding:10px 14px; border-radius:12px; cursor:pointer;
    }
    button:hover { background:rgba(255,255,255,.18); }
    .status { margin-top:12px; opacity:.8; font-size:13px; }
    .pill { display:inline-block; padding:6px 10px; border-radius:999px; background:rgba(255,255,255,.12); margin-right:8px; }
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="pill">Pocket Guardian Tail</div>
      <div class="pill">Auto-load from GitHub folders</div>
    </div>
  </header>

  <main class="wrap">
    <div class="viewer">
      <img id="slideImg" alt="slide" />
    </div>
    <div class="caption" id="caption"></div>

    <div class="controls">
      <button id="prevBtn">‚¨ÖÔ∏è ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
      <button id="nextBtn">‡∏ñ‡∏±‡∏î‡πÑ‡∏õ ‚û°Ô∏è</button>
      <button id="toggleAutoBtn">‚ñ∂Ô∏è ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</button>
      <button id="reloadBtn">üîÑ ‡πÇ‡∏´‡∏•‡∏î‡πÉ‡∏´‡∏°‡πà</button>
    </div>

    <div class="status" id="status">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‚Ä¶</div>
  </main>

<script>
(async function () {
  // === ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ ===
  const owner = "sopwerdream";
  const repo  = "Pocket-Guardian-Tail";
  const branch = "main";

  // ‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå ‚Äú‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô repo ‡∏à‡∏£‡∏¥‡∏á‚Äù (‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ï‡πâ assets/)
  const folders = [
    "cover 01_First page cover image",
    "cover 02_Concept Visual for the Menu",
  ];

  const statusEl  = document.getElementById("status");
  const imgEl     = document.getElementById("slideImg");
  const capEl     = document.getElementById("caption");
  const prevBtn   = document.getElementById("prevBtn");
  const nextBtn   = document.getElementById("nextBtn");
  const reloadBtn = document.getElementById("reloadBtn");
  const toggleAutoBtn = document.getElementById("toggleAutoBtn");

  let slides = [];
  let idx = 0;
  let autoTimer = null;

  function setStatus(msg){ statusEl.textContent = msg; }

  function isImage(name){
    return /\.(png|jpg|jpeg|webp|gif)$/i.test(name);
  }

  async function fetchFolder(folderName){
    // GitHub contents API
    // https://api.github.com/repos/{owner}/{repo}/contents/{path}?ref={branch}
    const path = `assets/${folderName}`;
    const url = `https://api.github.com/repos/${owner}/${repo}/contents/${encodeURIComponent(path)}?ref=${encodeURIComponent(branch)}`;

    const res = await fetch(url, { headers: { "Accept": "application/vnd.github+json" } });
    if (!res.ok) throw new Error(`‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à: ${folderName} (${res.status})`);

    const data = await res.json();
    // data = array of items
    return data
      .filter(item => item.type === "file" && isImage(item.name))
      .map(item => ({
        name: item.name,
        folder: folderName,
        raw: item.download_url, // direct raw url
      }));
  }

  async function loadAll(){
    setStatus("‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏π‡∏õ‡∏à‡∏≤‡∏Å GitHub‚Ä¶");
    slides = [];
    idx = 0;

    for (const f of folders){
      setStatus(`‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡πà‡∏≤‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå: ${f}`);
      const items = await fetchFolder(f);
      slides.push(...items);
    }

    // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå (‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà/‡πÄ‡∏•‡∏Ç‡∏´‡∏ô‡πâ‡∏≤ ‡∏ö‡∏≠‡∏Å‡πÑ‡∏î‡πâ)
    slides.sort((a,b) => (a.folder + "/" + a.name).localeCompare(b.folder + "/" + b.name, undefined, { numeric:true }));

    if (!slides.length){
      setStatus("‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î (‡∏ï‡∏£‡∏ß‡∏à‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå/‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•‡πÑ‡∏ü‡∏•‡πå)");
      imgEl.removeAttribute("src");
      capEl.textContent = "";
      return;
    }

    setStatus(`‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß: ${slides.length} ‡∏£‡∏π‡∏õ`);
    show(0);
  }

  function show(i){
    if (!slides.length) return;
    idx = (i + slides.length) % slides.length;
    const s = slides[idx];
    imgEl.src = s.raw;
    capEl.textContent = `[${idx+1}/${slides.length}] assets/${s.folder}/${s.name}`;
  }

  function next(){ show(idx + 1); }
  function prev(){ show(idx - 1); }

  function toggleAuto(){
    if (autoTimer){
      clearInterval(autoTimer);
      autoTimer = null;
      toggleAutoBtn.textContent = "‚ñ∂Ô∏è ‡πÄ‡∏•‡πà‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥";
      return;
    }
    autoTimer = setInterval(next, 3000); // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡πÑ‡∏î‡πâ
    toggleAutoBtn.textContent = "‚è∏Ô∏è ‡∏´‡∏¢‡∏∏‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥";
  }

  prevBtn.addEventListener("click", prev);
  nextBtn.addEventListener("click", next);
  reloadBtn.addEventListener("click", () => loadAll().catch(err => setStatus(err.message)));
  toggleAutoBtn.addEventListener("click", toggleAuto);

  // ‡∏Ñ‡∏µ‡∏¢‡πå‡∏ö‡∏≠‡∏£‡πå‡∏î
  window.addEventListener("keydown", (e) => {
    if (e.key === "ArrowRight") next();
    if (e.key === "ArrowLeft") prev();
  });

  // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏´‡∏•‡∏î
  loadAll().catch(err => setStatus(err.message));
})();
</script>
</body>
</html>
