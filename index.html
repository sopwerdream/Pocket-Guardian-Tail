<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pocket Guardian Tail — Slide 1</title>
  <style>
    html, body { height: 100%; margin: 0; }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans Thai", sans-serif;
      overflow: hidden;
      background: #000;
    }

    /* Fullscreen background slideshow */
    .bg {
      position: fixed;
      inset: 0;
      background: #000;
      background-size: cover;
      background-position: center;
      transform: scale(1.02);
      filter: saturate(1.05) contrast(1.05);
      transition: opacity 700ms ease;
      opacity: 0;
    }
    .bg.show { opacity: 1; }

    /* Optional dark overlay */
    .overlay {
      position: fixed;
      inset: 0;
      background: linear-gradient(180deg, rgba(0,0,0,.12), rgba(0,0,0,.42));
      pointer-events: none;
    }

    /* Minimal navigation only */
    .nav {
      position: fixed;
      left: 24px;
      right: 24px;
      bottom: 22px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      z-index: 10;
    }

    .leftControls{
      display:flex;
      align-items:center;
      gap:10px;
      min-width: 0;
    }

    .btn {
      border: 1px solid rgba(255,255,255,.22);
      background: rgba(0,0,0,.35);
      color: #fff;
      padding: 10px 14px;
      border-radius: 14px;
      cursor: pointer;
      font-weight: 800;
      letter-spacing: .2px;
      backdrop-filter: blur(10px);
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .btn:hover { background: rgba(0,0,0,.50); }

    /* Tiny status (optional) */
    .status {
      color: rgba(255,255,255,.75);
      font-size: 12px;
      user-select: none;
      max-width: 60vw;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
    }

    /* ===== Info Panel (collapsible drawer) ===== */
    .panelScrim{
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,.40);
      opacity: 0;
      pointer-events: none;
      transition: opacity .20s ease;
      z-index: 20;
    }
    .panel{
      position: fixed;
      right: 18px;
      top: 18px;
      bottom: 18px;
      width: min(460px, calc(100vw - 36px));
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,.20);
      background: rgba(0,0,0,.42);
      backdrop-filter: blur(14px);
      box-shadow: 0 30px 80px rgba(0,0,0,.45);
      transform: translateX(110%);
      transition: transform .25s ease;
      z-index: 30;
      display:flex;
      flex-direction:column;
      overflow:hidden;
    }
    .panelHeader{
      padding: 14px 14px 12px;
      border-bottom: 1px solid rgba(255,255,255,.14);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .panelTitle{
      display:flex;
      flex-direction:column;
      gap:2px;
      min-width:0;
    }
    .panelTitle b{
      font-size: 14px;
      letter-spacing:.2px;
    }
    .panelTitle span{
      font-size: 12px;
      color: rgba(255,255,255,.75);
      overflow:hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .panelBody{
      padding: 14px;
      overflow:auto;
      color: rgba(255,255,255,.86);
      animation: none;
    }
    .panelBody h3{
      margin: 0 0 10px 0;
      font-size: 14px;
    }
    .panelBody p{
      margin: 0 0 12px 0;
      font-size: 13px;
      line-height: 1.6;
      color: rgba(255,255,255,.80);
    }
    .chips{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      margin: 10px 0 14px;
    }
    .chip{
      padding: 7px 10px;
      border-radius: 999px;
      border: 1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.08);
      font-size: 12px;
      color: rgba(255,255,255,.82);
    }
    .grid3{
      display:grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap:10px;
    }
    .box{
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      border-radius: 14px;
      padding: 10px;
    }
    .box b{
      display:block;
      font-size: 12px;
      margin-bottom: 4px;
    }
    .box span{
      display:block;
      font-size: 11px;
      line-height: 1.45;
      color: rgba(255,255,255,.76);
    }

    /* panel open state */
    .open .panel{ transform: translateX(0); }
    .open .panelScrim{ opacity: 1; pointer-events: auto; }

    /* text fade when opening */
    .open .panelBody{
      animation: fadeIn .18s ease;
    }
    @keyframes fadeIn{
      from { opacity: 0; transform: translateY(6px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    @media (max-width: 860px){
      .grid3{ grid-template-columns: 1fr; }
      .status{ max-width: 46vw; }
    }
  </style>
</head>

<body>
  <div id="bg" class="bg"></div>
  <div class="overlay"></div>

  <!-- Collapsible info panel -->
  <div id="scrim" class="panelScrim" aria-hidden="true"></div>
  <aside id="panel" class="panel" aria-label="Info panel" aria-hidden="true">
    <div class="panelHeader">
      <div class="panelTitle">
        <b>Pocket Guardian Tail — Info</b>
        <span id="panelSub">Slide 1 • Cover Set</span>
      </div>
      <button class="btn" id="closeBtn" type="button" aria-label="Close info">✕</button>
    </div>

    <div class="panelBody" id="panelBody">
      <div class="chips">
        <span class="chip">Genre: Action / Adventure</span>
        <span class="chip">Platform: PC / Console (Demo)</span>
        <span class="chip" id="chipCount">Cover Set: …</span>
      </div>

      <h3>Concept (TH)</h3>
      <p>
        เมื่อเอเลี่ยนบุกโลกและจับผู้คนไป ตัวละครถูกดึงเข้าสู่ “Pocket World” —
        มิติทางผ่านที่เชื่อมโลกมนุษย์กับเทคโนโลยีของเอเลี่ยน เป้าหมายคือเอาตัวรอด
        สร้างพลัง และหาทางกลับโลกให้ได้
      </p>

      <h3>Concept (EN)</h3>
      <p>
        Survive the Pocket World, build power & allies, and fight your way back home.
      </p>

      <div class="grid3">
        <div class="box">
          <b>Hook</b>
          <span>Earth ↔ Pocket World • Sci-Fi x Fantasy</span>
        </div>
        <div class="box">
          <b>Core Loop</b>
          <span>Explore → Engage → Battle → Recover → Grow</span>
        </div>
        <div class="box">
          <b>Pitch Goal</b>
          <span>Show feasibility of Demo + key systems + visual mood</span>
        </div>
      </div>
    </div>
  </aside>

  <div class="nav">
    <div class="leftControls">
      <button class="btn" id="infoBtn" type="button">ℹ️ Info</button>
      <div class="status" id="status">Loading cover images…</div>
    </div>

    <button class="btn" id="nextBtn" type="button">Next ➜</button>
  </div>

  <script>
    // ====== CONFIG ======
    const OWNER  = "sopwerdream";
    const REPO   = "Pocket-Guardian-Tail";
    const BRANCH = "main";

    // Slide 1 background images folder (Cover 01)
    const FOLDER = "assets/cover 01_First page cover image";

    // slideshow speed (ms)
    const INTERVAL = 3500;

    // navigation
    const NEXT_PAGE = "slide2.html";

    // ====== ELEMENTS ======
    const bgEl = document.getElementById("bg");
    const statusEl = document.getElementById("status");
    const nextBtn = document.getElementById("nextBtn");

    // panel elements
    const root = document.documentElement;
    const scrim = document.getElementById("scrim");
    const panel = document.getElementById("panel");
    const infoBtn = document.getElementById("infoBtn");
    const closeBtn = document.getElementById("closeBtn");
    const chipCount = document.getElementById("chipCount");
    const panelSub = document.getElementById("panelSub");

    // ====== HELPERS ======
    function isImage(name){
      return /\.(png|jpg|jpeg|webp|gif)$/i.test(name);
    }

    async function fetchFolderImages(folderPath){
      const api = `https://api.github.com/repos/${OWNER}/${REPO}/contents/${encodeURIComponent(folderPath)}?ref=${encodeURIComponent(BRANCH)}`;
      const res = await fetch(api, { headers: { "Accept": "application/vnd.github+json" } });
      if(!res.ok) throw new Error(`Folder load failed: ${folderPath} (${res.status})`);
      const data = await res.json();
      return data
        .filter(item => item.type === "file" && isImage(item.name))
        .map(item => ({ name: item.name, raw: item.download_url }))
        .sort((a,b) => a.name.localeCompare(b.name, undefined, { numeric:true }));
    }

    function setBg(url, label){
      bgEl.classList.remove("show");
      setTimeout(() => {
        bgEl.style.backgroundImage = `url('${url}')`;
        bgEl.classList.add("show");
        statusEl.textContent = label;
        panelSub.textContent = `Slide 1 • ${label}`;
      }, 40);
    }

    function goNext(){
      window.location.href = NEXT_PAGE; // ✅ Next = เปลี่ยนหน้าเท่านั้น
    }

    function openPanel(){
      document.body.classList.add("open");
      panel.setAttribute("aria-hidden", "false");
      scrim.setAttribute("aria-hidden", "false");
    }
    function closePanel(){
      document.body.classList.remove("open");
      panel.setAttribute("aria-hidden", "true");
      scrim.setAttribute("aria-hidden", "true");
    }
    function togglePanel(){
      if(document.body.classList.contains("open")) closePanel();
      else openPanel();
    }

    // ====== INIT ======
    (async function init(){
      nextBtn.addEventListener("click", goNext);

      infoBtn.addEventListener("click", togglePanel);
      closeBtn.addEventListener("click", closePanel);
      scrim.addEventListener("click", closePanel);

      window.addEventListener("keydown", (e) => {
        if (e.key === "ArrowRight") goNext();
        if (e.key === "i" || e.key === "I") togglePanel();
        if (e.key === "Escape") closePanel();
      });

      try{
        const images = await fetchFolderImages(FOLDER);
        chipCount.textContent = `Cover Set: ${images.length} images`;

        if(!images.length){
          statusEl.textContent = `No images found in: ${FOLDER}`;
          return;
        }

        let i = 0;
        setBg(images[i].raw, `cover 01 • ${images[i].name}`);

        setInterval(() => {
          i = (i + 1) % images.length;
          setBg(images[i].raw, `cover 01 • ${images[i].name}`);
        }, INTERVAL);
      } catch (err){
        statusEl.textContent = err.message;
        chipCount.textContent = "Cover Set: Error";
      }
    })();
  </script>
</body>
</html>
